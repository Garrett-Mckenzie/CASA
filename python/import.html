<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html">
        <title>Import/Export | Rappahannock CASA</title>
        <link rel="stylesheet" href="styler.scss">
        <script type="text/javascript">
            function togglePopup(){
                var pop = document.getElementById('popup');
                pop.focus();
                pop.style.visibility = (pop.style.visibility === 'visible') ? 'hidden' : 'visible';
            }

            var files;
            function displayImport(event){
                files = event.target.files;
                const fileList = event.target.files;
                const fileDisplay = document.getElementById('fileDisplay');
                fileDisplay.innerHTML = '';

                for(let i = 0; i < fileList.length; i++){
                    const listItem = document.createElement('li');
                    listItem.textContent = fileList[i].name;
                    fileDisplay.appendChild(listItem);
                }
            }
        </script>
        <script type="text/php">
            <?php
                if(isset($_GET['success'])){
                    echo "console.log('Import file: " . htmlspecialchars($_GET['success'], ENT_QUOTES, 'UTF-8') . "');";
                    $file = htmlspecialchars($_GET['file'], ENT_QUOTES, 'UTF-8');
                }
            ?>
        </script>
    </head>
    <body>
        <header>
            <nav>
                <table></table>
            </nav>
        </header>
        <main>
            <div id="popup" style="visibility: hidden;">
                <p><a id="popLink"></a></p>
                <button onclick="togglePopup()">Close</button>
            </div>
            <form action="ImportHandler.php" method="post" enctype="multipart/form-data">
                <!-- Add CSV Compatibility -->
                <input type="file" name="files[]" accept=".xlsx, .xls" multiple="multiple" onchange="displayImport(event)">
                <ul id="fileDisplay" class="display"></ul>
                <button type="submit">Import</button>
            </form>
        </main>
    </body>
</html>